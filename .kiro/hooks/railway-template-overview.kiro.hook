{
  "enabled": true,
  "name": "railway-template-overview",
  "description": "Generate a concise Railway hosting overview for the current repository, including 1-click deploy link, setup, dependencies, and reasons to use Railway.",
  "version": "1",
  "when": {
    "type": "userTriggered",
    "patterns": ["*"]
  },
  "then": {
    "type": "askAgent",
    "prompt": "You are creating a short \"Railway Template Overview\" document for the current repository. Copy the Final Output below into `PITCH/RAILWAY-TEMPLATE.md` (or your README) as needed.\n\nGather project metadata first (prefer automation; do not invent details):\n\n- Project name: from `package.json:name`; else the repository folder name\n- Description: concise ~50 words from `README.md` intro or `package.json:description`\n- Runtime: from `package.json:engines.node`; default to Node.js 20+ if absent\n- Scripts: determine build/start from `package.json:scripts`\n  - Prefer: `build`, `start`; else infer common patterns per framework\n- Package manager: prefer pnpm, fallback to yarn (never npm)\n- Framework hints (optional): detect via dependencies\n  - Remix (`@remix-run/*`), Next.js (`next`), Express (`express`), NestJS (`@nestjs/*`), Astro (`astro`), SvelteKit (`@sveltejs/kit`), Nuxt (`nuxt`)\n\nCompute a Railway 1‑click deploy URL for this repo (fish shell):\n\n```fish\n# Get remote and normalize to https URL\nset ORIGIN (git config --get remote.origin.url)\nif test -z \"$ORIGIN\"\n  echo \"No git remote.origin.url found\"; end\nset HTTPS_URL (string replace -r '^git@([^:]+):(.+?)(\\.git)?$' 'https://$1/$2' -- $ORIGIN)\nset HTTPS_URL (string replace -r '^(https?://.+?)(\\.git)$' '$1' -- $HTTPS_URL)\n\n# URL-encode for Railway template param\nset TEMPLATE_ENC (python3 -c \"import sys,urllib.parse as u; print(u.quote(sys.argv[1], safe=''))\" $HTTPS_URL)\nset RAILWAY_1CLICK https://railway.app/new?template=$TEMPLATE_ENC\necho $RAILWAY_1CLICK\n```\n\nCompute framework docs links (fish shell):\n\n```fish\n# Build a comma-separated list of framework docs links based on dependencies\nset PJSON (cat package.json)\nset LINKS\nif string match -rq '\"@remix-run/' -- $PJSON\n    set LINKS $LINKS '[Remix docs](https://remix.run/docs)'\nend\nif string match -rq '\"next\"' -- $PJSON\n    set LINKS $LINKS '[Next.js docs](https://nextjs.org/docs)'\nend\nif string match -rq '\"express\"' -- $PJSON\n    set LINKS $LINKS '[Express docs](https://expressjs.com/)'\nend\nif string match -rq '\"@nestjs/' -- $PJSON\n    set LINKS $LINKS '[NestJS docs](https://docs.nestjs.com/)'\nend\nif string match -rq '\"astro\"' -- $PJSON\n    set LINKS $LINKS '[Astro docs](https://docs.astro.build/)'\nend\nif string match -rq '\"@sveltejs/kit\"' -- $PJSON\n    set LINKS $LINKS '[SvelteKit docs](https://kit.svelte.dev/docs)'\nend\nif string match -rq '\"nuxt\"' -- $PJSON\n    set LINKS $LINKS '[Nuxt docs](https://nuxt.com/docs)'\nend\nif test (count $LINKS) -gt 0\n    set FRAMEWORK_DOCS (string join ', ' $LINKS)\nelse\n    set FRAMEWORK_DOCS 'N/A'\nend\necho $FRAMEWORK_DOCS\n```\n\nBuild/Start guidance (use detected scripts; examples):\n\n- Build: `pnpm run build`; fallback `yarn build`\n- Start: `pnpm start`; fallback `yarn start`\n- Ensure the server binds to `$PORT` provided by Railway\n\nNotes:\n\n- Keep instructions framework‑agnostic; add specific notes only when confidently detected\n- Ensure the Final Output does not contain placeholders. Replace any angle-bracket tokens (e.g., <repo name>) with concrete values detected from this repository.\n\nFinal Output:\n\n```markdown\n# Deploy and Host {{ project_name }} on Railway\n\n{{ project_description }}\n\n## One click deploy url\n\n{{ railway_1click_url }}\n\n## About Hosting {{ project_name }}\n\n{{ hosting_description }}\n\n## Common Use Cases\n\n- <use case 1 based on app type>\n- <use case 2>\n\n## Dependencies for {{ project_name }} Hosting\n\n{{ project_dependencies }}\n\n### Deployment Dependencies\n\n{{ deployment_dependencies }}\n\n## Using .kiro Automation (optional)\n\n{{ kiro_automation_section }}\n\n## Why Deploy {{ project_name }} on Railway?\n\n{{ railway_benefits }}\n\n```"
  }
}
